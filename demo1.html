<!doctype html>
<html>
<head>
  <meta charset='utf-8'>
  <title>ATI 2015 - Demo consumir API Rest desde HTML + Javascript pelado </title>
</head>

<body>
<article>
  <header>
  <h1>ATI 2015 - Demo consumir API Rest desde HTML + Javascript pelado </h1>
  <p>Todas las demos consumen la API "Ultimate Weather Forecasts": 
      <a href='https://www.mashape.com/george-vustrey/ultimate-weather-forecasts' target='blank'>
      https://www.mashape.com/george-vustrey/ultimate-weather-forecasts</a>
  </p>
  </header>
  
    <textarea id="textareaInput" style="width:100%; height:200px"></textarea>
    <button onclick="javascript:consumirAPI();">Consumir API</button>
    <span id="consumirAPIMsg" style="color:red; display:none;">Consumiendo información ...</span>
</article>
    <script>
        function consumirAPI() {
            var s = '';

            var url = "https://george-vustrey-weather.p.mashape.com/api.php?location=La+Plata";

            document.getElementById('consumirAPIMsg').innerHTML = 'Consumiendo información de ' + url;
            document.getElementById('consumirAPIMsg').style.display = '';


            var client = new XMLHttpRequest();
            client.open("GET", url, false);


            client.setRequestHeader("Content-Type", "application/json");
            client.setRequestHeader("X-Mashape-Key", "4gEggQQKGcmshXGE5So6cB3pT5oHp1LvV5ajsnF5GqpspCGVZI");
            client.send();

            if (client.status == 200) {
                document.getElementById('consumirAPIMsg').style.display = 'none';
                document.getElementById('textareaInput').value = client.responseText;
            }
            else {
                //alert("The request did not succeed!\n\nThe response status was: " + client.status + " " + client.statusText + ".");
                document.getElementById('consumirAPIMsg').innerHTML = 'Se produjo un error';
            }
        }
    </script>
</body>
</html>
